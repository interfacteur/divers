<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Proxies JSON, outils perso \ Canopée ~ outils / Equatorium</title>
<meta name="author" content="Gaëtan Langhade, interfacteur">

<style type="text/css">
body	{
	font-family: Georgia, "Times New Roman", Times, serif;
	font-size: 120%;
	margin-top: 4px;
}
a	{
	color: #000;
}
a:hover,
a:focus	{
	color:  #A00;
	text-decoration: none;
}
h1	{
	font-size: 1.075em;
}
h2	{
	font-size: 1em;
}
li	{
	margin-bottom: .5em;
}
form	{
	position: absolute;
	left: -4444em;
	top: 0;
}
[type="text"]	{
	width: 44em;
}
output	{
	font-size: .75em;
	height: 60px;
	display: block;
}
[type='submit']	{
	background: grey;
	border: 1px solid #8DA;
	color: #8DA;
	cursor: pointer;
	padding: .2em .75em;
}
</style>
</head>

<body>
<p>Autres outils : <a href="http://jsonpwrapper.com/">jsonpwrapper.com</a>, <a href="https://jsonp.afeld.me/">jsonp.afeld.me</a>, http://anyorigin.com/</p>
<h1>Proxies JSON, outils perso</h1>
<p><em>Sur API servant du JSON :</em></p>
<h2>Proxy <a href="proxy2jsonp.php">proxy2jsonp.php</a></h2>
<p>Retour JSON-P encapsulé par une fonction de callback manuelle ou jQuery :</p>
<ul>
	<li>À ne pas faire sans callback :<br>
		<a href="proxy2jsonp.php?query=http://www.interfacteur.net/apis/json.php">
		http://www.equatorium.net/e1/ou--outils/proxy2jsonp.php?query=<br>
		http://www.interfacteur.net/apis/json.php</a></li>
	<li>Callback manuel :<br>
		<a href="proxy2jsonp.php?query=http://www.interfacteur.net/apis/json.php&cb=perform">
		http://www.equatorium.net/e1/ou--outils/proxy2jsonp.php?query=<br>
		http://www.interfacteur.net/apis/json.php&cb=perform</a></li>
	<li>Callback jQuery :
		<ul>
			<li>
				<a href="proxy2jsonp.php?query=http://www.interfacteur.net/apis/json.php&callback=jQuery956_123&_=124">
				http://www.equatorium.net/e1/ou--outils/proxy2jsonp.php?query=<br>
				http://www.interfacteur.net/apis/json.php&callback=jQuery956_123&_=124</a>
			</li>
			<li>
				<a href="proxy2jsonp.php?query=http://www.interfacteur.net/apis/json.php&cb=perform&callback=jQuery956_123&_=124">
				http://www.equatorium.net/e1/ou--outils/proxy2jsonp.php?query=<br>
				http://www.interfacteur.net/apis/json.php&cb=perform&callback=jQuery956_123&_=124</a>
			</li>
		</ul>
	</li>
</ul>
<form action="#">
	<label for="test1">Test localisé :</label>
	<input type="text" id="test1" />
	Callback :
	<input type="radio" id="cb11" name="cb1" value="0" /><label for="cb11">manuel</label>
	<input type="radio" id="cb12" name="cb1" value="1" checked /><label for="cb12">jQuery</label>
	<input type="submit" value="Tester" />
	<br>
	<output id="resultat1"></output>
</form>
<h2>Proxy <a href="proxy2json-.php">proxy2json-.php</a></h2>
<p>Retour JSON, ou JSON-P encapsulé par une fonction de callback manuelle ou jQuery :</p>
<ul>
	<li>Retour JSON :<br>
		<a href="proxy2json-.php?query=http://www.interfacteur.net/apis/json.php">
		http://www.equatorium.net/e1/ou--outils/proxy2json-.php?query=<br>
		http://www.interfacteur.net/apis/json.php</a></li>
	<li>Callback manuel :<br>
		<a href="proxy2json-.php?query=http://www.interfacteur.net/apis/json.php&cb=perform">
		http://www.equatorium.net/e1/ou--outils/proxy2json-.php?query=<br>
		http://www.interfacteur.net/apis/json.php&cb=perform</a></li>
	<li>Callback jQuery :
		<ul>
			<li>
				<a href="proxy2json-.php?query=http://www.interfacteur.net/apis/json.php&callback=jQuery956_123&_=124">
				http://www.equatorium.net/e1/ou--outils/proxy2json-.php?query=<br>
				http://www.interfacteur.net/apis/json.php&callback=jQuery956_123&_=124</a>
			</li>
			<li>
				<a href="proxy2json-.php?query=http://www.interfacteur.net/apis/json.php&cb=perform&callback=jQuery956_123&_=124">
				http://www.equatorium.net/e1/ou--outils/proxy2json-.php?query=<br>
				http://www.interfacteur.net/apis/json.php&cb=perform&callback=jQuery956_123&_=124</a>
			</li>
		</ul>
	</li>
</ul>
<form action="#">
	<label for="test2">Test localisé :</label>
	<input type="text" id="test2" />
	Callback :
	<input type="radio" id="cb23" name="cb2" value="-1" checked /><label for="cb23">aucun</label>
	<input type="radio" id="cb21" name="cb2" value="0" /><label for="cb21">manuel</label>
	<input type="radio" id="cb22" name="cb2" value="1" /><label for="cb22">jQuery</label>
	<input type="submit" value="Tester" />
	<br>
	<output id="resultat2"></output>
</form>
<script src="-media/jquery-2.1.1.min.js"></script>
<script>
;$(function () {
	"use strict";
	var reURL = /^(?:(?:https?):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,}))\.?)(?::\d{2,5})?(?:[/?#]\S*)?$/i, //https://gist.github.com/dperini/729294
		$inputs = [
			[$("#test1"), $("[name='cb1']"), $("#resultat1")],
			[$("#test2"), $("[name='cb2']"), $("#resultat2")]
		],
		proxies = ["p", "-"];
	$("form").each(function (i) {
		$(this).on("submit", function (e) {
			e.preventDefault();
			var url = $inputs[i][0].val(),
				type = $inputs[i][1].filter(":checked").val() || (i == 0 ? 1 : -1);
			if (! reURL.test(url))
				return;
			$.ajax({
				url: "http://www.equatorium.net/e1/ou--outils/proxy2json" + proxies[i] + ".php?query=" + url,
				dataType: type == -1 ? "json" : "jsonp",
				jsonp: type == 0 ? "cb" : this.jsponp,
				jsonpCallback: type == 0 ? "perform" : this.jsonpCallback,
				success: function (got, status, xhr) {
					$inputs[i][2].html(this.url + "<br>" + xhr.responseText.substring(0, 200));
				},
				error: function (xhr, status, err) {
					console.log(err);
}	});	});	});	});
</script>
</body>
</html>
